<div class="transacciones-emitidas-container">
  <!-- Breadcrumb -->
  <div class="breadcrumb-section mb-3">
    <span class="breadcrumb-item">Gestión</span>
    <i class="fas fa-chevron-right mx-2"></i>
    <span class="breadcrumb-item active">Transacciones Emitidas Paciente</span>
  </div>

  <!-- Filtros -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row">
        <!-- Paciente -->
        <div class="col-md-4 mb-3">
          <label for="paciente" class="form-label">Paciente</label>
          <div class="input-group">
            <input 
              type="text" 
              class="form-control" 
              [(ngModel)]="paciente"
              placeholder="Buscar paciente"
            />
            <div class="input-group-append">
              <button class="btn btn-outline-secondary" type="button">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Fecha Desde -->
        <div class="col-md-2 mb-3">
          <label for="fechaDesde" class="form-label">Fecha Desde</label>
          <input 
            type="text" 
            class="form-control" 
            [(ngModel)]="fechaDesde"
          />
        </div>

        <!-- Fecha Hasta -->
        <div class="col-md-2 mb-3">
          <label for="fechaHasta" class="form-label">Fecha Hasta</label>
          <input 
            type="text" 
            class="form-control" 
            [(ngModel)]="fechaHasta"
          />
        </div>

        <!-- Sucursal -->
        <div class="col-md-3 mb-3">
          <label for="sucursal" class="form-label">Sucursal</label>
          <select class="form-control" [(ngModel)]="sucursal">
            <option>Veris - Kennedy</option>
            <option>Veris - Centro</option>
            <option>Veris - Norte</option>
          </select>
        </div>

        <div class="col-md-1 mb-3 d-flex align-items-end">
          <button class="btn btn-primary btn-block" (click)="buscar()">
            <i class="fas fa-search"></i> Buscar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabla con Paginación -->
  <div class="card">
    <div class="card-header bg-primary text-white">
      <h6 class="mb-0">Veris - Kennedy</h6>
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-bordered mb-0">
          <thead class="thead-light">
            <tr>
              <th width="50">Acciones</th>
              <th>Reenviar Información</th>
              <th>Tirilla</th>
              <th>RIDE</th>
              <th>XML</th>
              <th>Orden Medica</th>
              <th>Fecha Transacción</th>
              <th>N° de Transacción</th>
              <th>Fecha Orden</th>
              <th>N° Orden</th>
              <th>N° Factura</th>
              <th>Beneficiario</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let transaction of paginatedTransactions">
              <td class="text-center">
                <button 
                  class="btn btn-sm btn-link p-0" 
                  (click)="toggleExpandRow(transaction)"
                >
                  <i class="fas fa-chevron-down"></i>
                </button>
              </td>
              <td class="text-center">
                <button class="btn btn-sm btn-primary" *ngIf="transaction.reenviarInfo">
                  <i class="fas fa-envelope"></i>
                </button>
              </td>
              <td class="text-center">
                <button 
                  class="btn btn-sm btn-info" 
                  (click)="downloadDocument('Tirilla', transaction)"
                >
                  <i class="fas fa-receipt"></i>
                </button>
              </td>
              <td class="text-center">
                <button 
                  class="btn btn-sm btn-success" 
                  (click)="downloadDocument('RIDE', transaction)"
                >
                  <i class="fas fa-file-pdf"></i>
                </button>
              </td>
              <td class="text-center">
                <button 
                  class="btn btn-sm btn-warning" 
                  (click)="downloadDocument('XML', transaction)"
                >
                  <i class="fas fa-file-code"></i>
                </button>
              </td>
              <td class="text-center">
                <button 
                  class="btn btn-sm btn-secondary" 
                  (click)="downloadDocument('Orden Médica', transaction)"
                >
                  <i class="fas fa-file-medical"></i>
                </button>
              </td>
              <td>{{ transaction.fechaTransaccion }}</td>
              <td>{{ transaction.numTransaccion }}</td>
              <td>{{ transaction.fechaOrden }}</td>
              <td>{{ transaction.numOrden }}</td>
              <td>{{ transaction.numFactura }}</td>
              <td>{{ transaction.beneficiario }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Paginación -->
      <div class="pagination-container">
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center mb-0">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <a class="page-link" href="javascript:void(0)" (click)="previousPage()">
                <i class="fas fa-angle-double-left"></i>
              </a>
            </li>
            <li class="page-item" [class.disabled]="currentPage === 1">
              <a class="page-link" href="javascript:void(0)" (click)="previousPage()">
                <i class="fas fa-angle-left"></i>
              </a>
            </li>
            <li 
              class="page-item" 
              *ngFor="let page of [].constructor(totalPages); let i = index"
              [class.active]="currentPage === i + 1"
            >
              <a class="page-link" href="javascript:void(0)" (click)="goToPage(i + 1)">
                {{ i + 1 }}
              </a>
            </li>
            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <a class="page-link" href="javascript:void(0)" (click)="nextPage()">
                <i class="fas fa-angle-right"></i>
              </a>
            </li>
            <li class="page-item" [class.disabled]="currentPage === totalPages">
              <a class="page-link" href="javascript:void(0)" (click)="goToPage(totalPages)">
                <i class="fas fa-angle-double-right"></i>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>